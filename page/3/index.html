<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>AGI Explained</title><meta name="author" content="Eryx Lee"><meta name="copyright" content="Eryx Lee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="AGI Explained">
<meta property="og:url" content="https://blog.agiexplained.com/page/3/index.html">
<meta property="og:site_name" content="AGI Explained">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pics.agiexplained.com/i/2024/03/05/171847_2.png">
<meta property="article:author" content="Eryx Lee">
<meta property="article:tag" content="AI,AGI,AIGC,OpenAI,ChatGPT,GPT,Multimodal,LLM,NLP,Transformer">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pics.agiexplained.com/i/2024/03/05/171847_2.png"><link rel="shortcut icon" href="https://pics.agiexplained.com/i/2024/03/05/171847.ico"><link rel="canonical" href="https://blog.agiexplained.com/page/3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8823ed47591706858ef7d0072102a1be";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'AGI Explained',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-01-30 11:11:37'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pics.agiexplained.com/i/2024/03/05/171847_2.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com"><i class="fa-fw fas fa-book"></i><span> 知识库</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com/#/ai/aiindex"><i class="fa-fw fas fa-book"></i><span> AI资源清单</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="AGI Explained"><span class="site-name">AGI Explained</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com"><i class="fa-fw fas fa-book"></i><span> 知识库</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com/#/ai/aiindex"><i class="fa-fw fas fa-book"></i><span> AI资源清单</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/07/07/SQLModel-user-guide/" title="SQLModel 使用技巧">SQLModel 使用技巧</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-07T05:53:46.000Z" title="发表于 2024-07-07 13:53:46">2024-07-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Python/">Python</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Python/">Python</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/SQLModel/">SQLModel</a></span></div><div class="content">1. 主键在数据库中，主键都是设置成非空的。不过在SQLModel中，主键需要设置成可空的，如：
1id: int | None = Field(default=None, primary_key=True)

这是因为这里的id 是由数据库自动生成的，而非在Python代码中。因此在创建一个实例的时候，一般都不会设置id，直到持久化到数据库中。因此，需要设置成可空字段，以免数据校验出错。
2. 连接数据库可以通过create_engine创建一个数据库连接：
1234sqlite_file_name = &quot;database.db&quot;sqlite_url = f&quot;sqlite:///&#123;sqlite_file_name&#125;&quot;engine = create_engine(sqlite_url, echo=True)

创建一个异步的数据库连接（需要安装aiosqlite包）：
123456789from sqlalchemy.ext.asyncio import create_async_enginefrom sqlmodel.ext ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/07/06/SQLModel-quickstart/" title="SQLModel 入门">SQLModel 入门</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-06T11:29:44.000Z" title="发表于 2024-07-06 19:29:44">2024-07-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Python/">Python</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Python/">Python</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/SQLModel/">SQLModel</a></span></div><div class="content">1. 简介SQLModel 建立在 SQLAlchemy 之上，提供了简化的连接管理和事务处理，同时直接支持 MySQL 数据类型和简化了外键和关系的定义，非常适合轻量级应用程序和小型项目。它可以使用 Pydantic 来定义模型，并且可以自动将这些模型映射到数据库表。这使得开发者可以轻松地进行数据库操作，而无需编写大量的 SQL 代码。
2. 安装首先，需要安装 FastAPI 和 SQLModel：
12pip install fastapi[all]pip install sqlmodel

3. 定义模型使用 SQLModel 定义模型非常简单。你只需要从 SQLModel 继承并添加字段即可。
123456from sqlmodel import SQLModel, Fieldclass User(SQLModel, table=True):    id: int = Field(default=None, primary_key=True)    name: str    age: int

4. SQLModel的独特之处
基于Pydantic，继承了 Pydantic  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/23/pytest-cov/" title="pytest 单元测试覆盖率">pytest 单元测试覆盖率</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-23T08:06:36.000Z" title="发表于 2024-06-23 16:06:36">2024-06-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/pytest/">pytest</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/pytest/">pytest</a></span></div><div class="content">pytest-cov 是一个用于测量 Python 代码测试覆盖率的 pytest 插件。它允许你在运行测试时自动收集覆盖率数据，并在测试完成后显示一个详细的报告。这对于确保你的代码库被充分测试非常有用。以下是如何使用 pytest-cov 的基本步骤：
安装首先，你需要确保已经安装了 pytest。如果尚未安装，可以通过 pip 安装它：
1pip install pytest

然后，安装 pytest-cov：
1pip install pytest-cov

使用安装后，你可以在命令行中使用 --cov 选项来运行 pytest 并收集覆盖率数据。
示例假设你的项目结构如下：
12345678your_project/  │  ├── your_module/  │   ├── __init__.py  │   └── your_script.py  │  └── tests/      └── test_your_script.py

在命令行中，你可以运行以下命令来收集 your_module 目录下的代码覆盖率数据：
1pytest --cov=your_module

 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/20/pytest-conftest-example/" title="pytest conftest 案例">pytest conftest 案例</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-20T12:06:39.000Z" title="发表于 2024-06-20 20:06:39">2024-06-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/pytest/">pytest</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/pytest/">pytest</a></span></div><div class="content">一个FastAPI 项目 conftest.py 的案例，主要包含了配置文件定义、测试数据库的初始化、数据库session创建、HTTP客户端创建等fixture。
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100@pytest_asyncio.fixture(scope=&quot;session&quot;, autouse=True)async def application():    &quot;&quot;&quot;应用app.&quot;&quot;&quot;    from app.main import app    yield app@pytest_asyncio.fixture(scope=&quot;session&quot;, ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/15/pytest-conftest/" title="pytest conftest">pytest conftest</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-15T06:59:39.000Z" title="发表于 2024-06-15 14:59:39">2024-06-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/pytest/">pytest</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/pytest/">pytest</a></span></div><div class="content">conftest.py 是 pytest 中的一个特殊文件，用于定义全局的配置、夹具（fixtures）、钩子函数和插件。下面将详细解析 conftest.py 文件的用法，包括使用方法、规则、建议和案例。
使用方法
创建 conftest.py 文件：在项目根目录或子目录下创建 conftest.py 文件。这个文件不需要显式导入，pytest 会自动识别并执行其中的配置。
定义夹具（fixtures）：在 conftest.py 中，可以使用 @pytest.fixture 装饰器来定义全局夹具。这些夹具可以在多个测试模块中被共享和使用。
定义钩子函数：conftest.py 还可以定义全局的钩子函数，如 pytest_runtest_setup 和 pytest_runtest_teardown，这些函数分别在测试用例执行前后执行。
配置全局信息：在 conftest.py 中，可以定义一些全局的配置信息，如日志级别、报告输出路径等。
导入自定义插件：conftest.py 还可以用于导入自定义的 pytest 插件，以扩展 pytest 的功能。

规则
文件名称固定：conf ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/10/pytest-fixture/" title="pytest fixture 使用">pytest fixture 使用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-10T11:42:10.000Z" title="发表于 2024-06-10 19:42:10">2024-06-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/pytest/">pytest</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/pytest/">pytest</a></span></div><div class="content">在自动化测试中，测试环境的准备与清理是确保测试稳定性和可重复性的关键步骤。pytest 框架通过其内置的 fixture 机制，为测试提供了灵活且强大的初始化与清理方案。本文将深入探讨 pytest fixture 的工作原理、使用场景、高级特性及其在实际测试中的应用。
一、Fixture 概述Fixture 是 pytest 中用于设置测试前置条件、执行测试后清理工作的功能。它可以是任何函数、类或者模块，通过特定的装饰器进行标记，以便 pytest 在测试执行过程中自动调用。Fixture 的设计哲学是“显式优于隐式”，它鼓励开发者在测试代码中明确指定测试依赖的资源和清理工作，从而提高代码的可读性和可维护性。
二、Fixture 的基本用法1. 定义 Fixture使用 @pytest.fixture 装饰器来定义一个 fixture。fixture 函数可以接收参数，并返回一个值，这个值会被测试函数作为参数接收。
123456789101112import pytest    @pytest.fixture  def database():      # 设置数据库连接       ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/07/pytest-basic/" title="pytest 简介">pytest 简介</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-07T10:26:59.000Z" title="发表于 2024-06-07 18:26:59">2024-06-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/pytest/">pytest</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/pytest/">pytest</a></span></div><div class="content">pytest是一个功能强大且易于使用的Python测试框架，它主要用于编写单元测试、集成测试和功能测试。
一、pytest的安装
安装命令：pip install pytest
验证安装：使用pytest --version命令来查看已安装的pytest版本，如果终端显示一个版本号，则说明安装成功。

二、pytest的命名规范
测试模块：测试文件应以”test_”开头或以”_test”结尾，例如test_login.py或user_test.py。
测试类：测试类必须以Test开头命名，且测试类中不能有__init__方法。
测试方法&#x2F;测试函数：测试方法&#x2F;测试函数必须以test开头。

三、pytest的常用运行参数
无参数：读取路径下符合条件的所有类、函数、方法全部执行。
-v：打印详细运行日志。
-s：打印print输出。
-k：跳过运行某个或某些用例，如pytest -k &#39;类名&#39;、pytest -k &#39;方法名&#39;。
-x：运行用例失败立即停止运行。
–maxfail：用例失败数达到某个设定的值停止运行，如pytest --ma ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/05/31/FastAPI-redis-om/" title="FastAPI redis-om 使用指南">FastAPI redis-om 使用指南</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-05-31T11:16:54.000Z" title="发表于 2024-05-31 19:16:54">2024-05-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/FastAPI/">FastAPI</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Cache/">Cache</a></span></div><div class="content">redis-om 是一个用于在 Redis 中存储和查询对象的高级库。它提供了一种简单的方式来将 Python 对象映射到 Redis 数据结构上。结合 FastAPI，你可以快速构建高性能的 API 服务。以下是使用 FastAPI 和 redis-om 的一些基本步骤。
安装依赖首先，你需要安装 FastAPI 和 redis-om 库。
12pip install fastapi[all]  # 安装 FastAPI 及其所有推荐依赖pip install redis-om     # 安装 redis-om

定义模型使用 redis-om 定义一个模型，该模型将映射到 Redis 数据库中的数据。
1234567891011121314from redis_om import HashModelclass Book(HashModel):    title: str    author: str    page_count: int    genre: str    class Meta:        global_key_prefix = &quot;test&quot; ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/05/29/FastAPI-Cache-key-builder/" title="FastAPI Cache 自定义 key builder">FastAPI Cache 自定义 key builder</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-05-29T12:23:15.000Z" title="发表于 2024-05-29 20:23:15">2024-05-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/FastAPI/">FastAPI</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Cache/">Cache</a></span></div><div class="content">FastAPI Cache的@cache 装饰器会自动收集被装饰的函数参数，构建缓存key。不过在实际使用过程中，默认key builder会在有些场景下会不适用。
1、不包含self的key builder主要用于装饰一个类中的方法，需要在构建key的时候去掉参数的类方法中的self参数。
123456789101112131415161718192021def noself_key_builder(    func: Callable,    namespace: Optional[str] = &quot;&quot;,    request: Optional[Request] = None,    response: Optional[Response] = None,    args: Optional[tuple] = None,    kwargs: Optional[dict] = None,) -&gt; str:    &quot;&quot;&quot;使用在类函数上的cache key builder.    本key builder在计算key的时候忽略se ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/05/28/FastAPI-Cache/" title="FastAPI Cache">FastAPI Cache</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-05-28T04:34:58.000Z" title="发表于 2024-05-28 12:34:58">2024-05-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/FastAPI/">FastAPI</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/FastAPI/">FastAPI</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Cache/">Cache</a></span></div><div class="content">一、FastAPI Cache 配置要在 FastAPI 中使用缓存，我们可以使用 fastapi-cache 这个第三方库。下面是配置 fastapi-cache 的步骤：
1. 安装 fastapi-cache首先，安装 fastapi-cache 库。
1pip install fastapi-cache

2. 配置缓存后端fastapi-cache 支持多种缓存后端，如 Redis、Memcached 等。以下是一个使用 Redis 作为缓存后端的配置示例：
12345678910111213from fastapi import FastAPIfrom fastapi_cache import FastAPICachefrom fastapi_cache.backends.redis import RedisBackendfrom fastapi_cache.decorator import cacheapp = FastAPI()# 配置 Redis 缓存后端FastAPICache.init(    backend=RedisBackend(redis_url=&quo ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/#content-inner">6</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pics.agiexplained.com/i/2024/03/05/171847_2.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Eryx Lee</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">58</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/eryxlee"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/01/llama.cpp-build-and-setup/" title="llama.cpp 编译使用">llama.cpp 编译使用</a><time datetime="2024-12-01T11:41:21.000Z" title="发表于 2024-12-01 19:41:21">2024-12-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/26/ollama-local-install-with-gpu/" title="使用ollama部署本地大模型（启用GPU）">使用ollama部署本地大模型（启用GPU）</a><time datetime="2024-11-26T06:30:41.000Z" title="发表于 2024-11-26 14:30:41">2024-11-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/25/ollama-local-install/" title="使用ollama部署本地大模型">使用ollama部署本地大模型</a><time datetime="2024-11-25T04:10:45.000Z" title="发表于 2024-11-25 12:10:45">2024-11-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/21/download-models-from-huggingface/" title="从Huggingface和魔搭下载大模型">从Huggingface和魔搭下载大模型</a><time datetime="2024-11-21T14:13:45.000Z" title="发表于 2024-11-21 22:13:45">2024-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/15/python-tips-2/" title="python 小技巧整理">python 小技巧整理</a><time datetime="2024-11-15T11:34:57.000Z" title="发表于 2024-11-15 19:34:57">2024-11-15</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/FastAPI/"><span class="card-category-list-name">FastAPI</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/LLM/"><span class="card-category-list-name">LLM</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/LangChain/"><span class="card-category-list-name">LangChain</span><span class="card-category-list-count">17</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Prompt/"><span class="card-category-list-name">Prompt</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Pydantic/"><span class="card-category-list-name">Pydantic</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python/"><span class="card-category-list-name">Python</span><span class="card-category-list-count">21</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/pytest/"><span class="card-category-list-name">pytest</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ruff/"><span class="card-category-list-name">ruff</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Cache/" style="font-size: 1.2em; color: #999da3">Cache</a> <a href="/tags/ollama/" style="font-size: 1.2em; color: #999da3">ollama</a> <a href="/tags/llama-cpp/" style="font-size: 1.1em; color: #999">llama.cpp</a> <a href="/tags/tools/" style="font-size: 1.1em; color: #999">tools</a> <a href="/tags/LangChain/" style="font-size: 1.45em; color: #99a7ba">LangChain</a> <a href="/tags/Celery/" style="font-size: 1.15em; color: #999b9e">Celery</a> <a href="/tags/LLM/" style="font-size: 1.25em; color: #999fa7">LLM</a> <a href="/tags/FastAPI/" style="font-size: 1.4em; color: #99a5b6">FastAPI</a> <a href="/tags/SQLModel/" style="font-size: 1.35em; color: #99a3b1">SQLModel</a> <a href="/tags/RAG/" style="font-size: 1.1em; color: #999">RAG</a> <a href="/tags/pytest/" style="font-size: 1.3em; color: #99a1ac">pytest</a> <a href="/tags/mkdocs/" style="font-size: 1.1em; color: #999">mkdocs</a> <a href="/tags/Pydantic/" style="font-size: 1.1em; color: #999">Pydantic</a> <a href="/tags/ruff/" style="font-size: 1.1em; color: #999">ruff</a> <a href="/tags/Docker/" style="font-size: 1.1em; color: #999">Docker</a> <a href="/tags/Prompt/" style="font-size: 1.1em; color: #999">Prompt</a> <a href="/tags/Python/" style="font-size: 1.5em; color: #99a9bf">Python</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><span class="card-archive-list-count">7</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">58</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-01-30T03:11:37.365Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Eryx Lee</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" href="https://beian.miit.gov.cn/">浙ICP备2024062350号-1</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>