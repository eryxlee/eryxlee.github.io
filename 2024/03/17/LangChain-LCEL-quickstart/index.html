<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LangChain LCEL quickstart | AGI Explained</title><meta name="author" content="Eryx Lee"><meta name="copyright" content="Eryx Lee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="LCEL makes it easy to build complex chains from basic components, and supports out of the box functionality such as streaming, parallelism, and logging. Basic example: prompt + model + output parserTh">
<meta property="og:type" content="article">
<meta property="og:title" content="LangChain LCEL quickstart">
<meta property="og:url" content="https://blog.agiexplained.com/2024/03/17/LangChain-LCEL-quickstart/index.html">
<meta property="og:site_name" content="AGI Explained">
<meta property="og:description" content="LCEL makes it easy to build complex chains from basic components, and supports out of the box functionality such as streaming, parallelism, and logging. Basic example: prompt + model + output parserTh">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pics.agiexplained.com/i/2024/03/05/171847_2.png">
<meta property="article:published_time" content="2024-03-17T13:36:54.000Z">
<meta property="article:modified_time" content="2024-03-18T08:40:46.000Z">
<meta property="article:author" content="Eryx Lee">
<meta property="article:tag" content="langchain">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pics.agiexplained.com/i/2024/03/05/171847_2.png"><link rel="shortcut icon" href="https://pics.agiexplained.com/i/2024/03/05/171847.ico"><link rel="canonical" href="https://blog.agiexplained.com/2024/03/17/LangChain-LCEL-quickstart/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LangChain LCEL quickstart',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-18 16:40:46'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pics.agiexplained.com/i/2024/03/05/171847_2.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com"><i class="fa-fw fas fa-book"></i><span> 知识库</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com/#/ai/aiindex"><i class="fa-fw fas fa-book"></i><span> AI资源清单</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="AGI Explained"><span class="site-name">AGI Explained</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com"><i class="fa-fw fas fa-book"></i><span> 知识库</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://kb.agiexplained.com/#/ai/aiindex"><i class="fa-fw fas fa-book"></i><span> AI资源清单</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">LangChain LCEL quickstart</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-17T13:36:54.000Z" title="发表于 2024-03-17 21:36:54">2024-03-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-18T08:40:46.000Z" title="更新于 2024-03-18 16:40:46">2024-03-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/langchain/">langchain</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="LangChain LCEL quickstart"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p>LCEL makes it easy to build complex chains from basic components, and supports out of the box functionality such as streaming, parallelism, and logging.</p>
<h2 id="Basic-example-prompt-model-output-parser"><a href="#Basic-example-prompt-model-output-parser" class="headerlink" title="Basic example: prompt + model + output parser"></a>Basic example: prompt + model + output parser<a target="_blank" rel="noopener" href="https://python.langchain.com/docs/expression_language/get_started#basic-example-prompt-model-output-parser"></a></h2><p>The most basic and common use case is chaining a prompt template and a model together. To see how this works, let’s create a chain that takes a topic and generates a joke:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%pip install --upgrade --quiet  langchain-core langchain-community langchain-openai</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser</span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"></span><br><span class="line">prompt = ChatPromptTemplate.from_template(<span class="string">&quot;tell me a short joke about &#123;topic&#125;&quot;</span>)</span><br><span class="line">model = ChatOpenAI(model=<span class="string">&quot;gpt-4&quot;</span>)</span><br><span class="line">output_parser = StrOutputParser()</span><br><span class="line"></span><br><span class="line">chain = prompt | model | output_parser</span><br><span class="line"></span><br><span class="line">chain.invoke(&#123;<span class="string">&quot;topic&quot;</span>: <span class="string">&quot;ice cream&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Why don&#x27;t ice creams ever get invited to parties?\n\nBecause they always drip when things heat up!&quot;</span><br></pre></td></tr></table></figure>



<p>Notice this line of this code, where we piece together then different components into a single chain using LCEL:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chain = prompt | model | output_parser</span><br></pre></td></tr></table></figure>



<p>The <code>|</code> symbol is similar to a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pipeline_(Unix)">unix pipe operator</a>, which chains together the different components feeds the output from one component as input into the next component.</p>
<p>In this chain the user input is passed to the prompt template, then the prompt template output is passed to the model, then the model output is passed to the output parser. Let’s take a look at each component individually to really understand what’s going on.</p>
<h3 id="1-Prompt"><a href="#1-Prompt" class="headerlink" title="1. Prompt"></a>1. Prompt<a target="_blank" rel="noopener" href="https://python.langchain.com/docs/expression_language/get_started#prompt"></a></h3><p><code>prompt</code> is a <code>BasePromptTemplate</code>, which means it takes in a dictionary of template variables and produces a <code>PromptValue</code>. A <code>PromptValue</code> is a wrapper around a completed prompt that can be passed to either an <code>LLM</code> (which takes a string as input) or <code>ChatModel</code> (which takes a sequence of messages as input). It can work with either language model type because it defines logic both for producing <code>BaseMessage</code>s and for producing a string.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">prompt_value = prompt.invoke(&#123;<span class="string">&quot;topic&quot;</span>: <span class="string">&quot;ice cream&quot;</span>&#125;)</span><br><span class="line">prompt_value</span><br></pre></td></tr></table></figure>



<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ChatPromptValue(messages=[HumanMessage(content=&#x27;tell me a short joke about ice cream&#x27;)])</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prompt_value.to_messages()</span><br></pre></td></tr></table></figure>



<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[HumanMessage(content=&#x27;tell me a short joke about ice cream&#x27;)]</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prompt_value.to_string()</span><br></pre></td></tr></table></figure>



<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;Human: tell me a short joke about ice cream&#x27;</span><br></pre></td></tr></table></figure>



<h3 id="2-Model"><a href="#2-Model" class="headerlink" title="2. Model"></a>2. Model<a target="_blank" rel="noopener" href="https://python.langchain.com/docs/expression_language/get_started#model"></a></h3><p>The <code>PromptValue</code> is then passed to <code>model</code>. In this case our <code>model</code> is a <code>ChatModel</code>, meaning it will output a <code>BaseMessage</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message = model.invoke(prompt_value)</span><br><span class="line">message</span><br></pre></td></tr></table></figure>



<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIMessage(content=&quot;Why don&#x27;t ice creams ever get invited to parties?\n\nBecause they always bring a melt down!&quot;)</span><br></pre></td></tr></table></figure>



<p>If our <code>model</code> was an <code>LLM</code>, it would output a string.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai.llms <span class="keyword">import</span> OpenAI</span><br><span class="line"></span><br><span class="line">llm = OpenAI(model=<span class="string">&quot;gpt-3.5-turbo-instruct&quot;</span>)</span><br><span class="line">llm.invoke(prompt_value)</span><br></pre></td></tr></table></figure>



<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;\n\nRobot: Why did the ice cream truck break down? Because it had a meltdown!&#x27;</span><br></pre></td></tr></table></figure>



<h3 id="3-Output-parser"><a href="#3-Output-parser" class="headerlink" title="3. Output parser"></a>3. Output parser<a target="_blank" rel="noopener" href="https://python.langchain.com/docs/expression_language/get_started#output-parser"></a></h3><p>And lastly we pass our <code>model</code> output to the <code>output_parser</code>, which is a <code>BaseOutputParser</code> meaning it takes either a string or a <code>BaseMessage</code> as input. The <code>StrOutputParser</code> specifically simple converts any input into a string.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">output_parser.invoke(message)</span><br></pre></td></tr></table></figure>



<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Why did the ice cream go to therapy? \n\nBecause it had too many toppings and couldn&#x27;t find its cone-fidence!&quot;</span><br></pre></td></tr></table></figure>



<h3 id="4-Entire-Pipeline"><a href="#4-Entire-Pipeline" class="headerlink" title="4. Entire Pipeline"></a>4. Entire Pipeline<a target="_blank" rel="noopener" href="https://python.langchain.com/docs/expression_language/get_started#entire-pipeline"></a></h3><p>To follow the steps along:</p>
<ol>
<li>We pass in user input on the desired topic as <code>&#123;&quot;topic&quot;: &quot;ice cream&quot;&#125;</code></li>
<li>The <code>prompt</code> component takes the user input, which is then used to construct a PromptValue after using the <code>topic</code> to construct the prompt.</li>
<li>The <code>model</code> component takes the generated prompt, and passes into the OpenAI LLM model for evaluation. The generated output from the model is a <code>ChatMessage</code> object.</li>
<li>Finally, the <code>output_parser</code> component takes in a <code>ChatMessage</code>, and transforms this into a Python string, which is returned from the invoke method.</li>
</ol>
<p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 1057.2421875 57.3984375" style="max-width: 1057.2421875px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg-4634317"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M178.195,20.699L184.749,20.699C191.302,20.699,204.409,20.699,217.516,20.699C230.622,20.699,243.729,20.699,250.283,20.699L256.836,20.699"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M389.766,20.699L401.453,20.699C413.141,20.699,436.516,20.699,459.891,20.699C483.266,20.699,506.641,20.699,518.328,20.699L530.016,20.699"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M620.375,20.699L632.146,20.699C643.918,20.699,667.461,20.699,691.004,20.699C714.547,20.699,738.09,20.699,749.861,20.699L761.633,20.699"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-F" id="L-D-F-0" d="M890.977,20.699L898.609,20.699C906.242,20.699,921.508,20.699,936.773,20.699C952.039,20.699,967.305,20.699,974.938,20.699L982.57,20.699"></path></g><g class="edgeLabels"><g transform="translate(217.515625, 20.69921875)" class="edgeLabel"><g transform="translate(-14.3203125, -13.19921875)" class="label"><foreignObject height="26.3984375" width="28.640625"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="edgeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204); background-color: rgb(88, 88, 88); text-align: center;">Dict</span></div></foreignObject></g></g><g transform="translate(459.890625, 20.69921875)" class="edgeLabel"><g transform="translate(-45.125, -13.19921875)" class="label"><foreignObject height="26.3984375" width="90.25"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="edgeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204); background-color: rgb(88, 88, 88); text-align: center;">PromptValue</span></div></foreignObject></g></g><g transform="translate(691.00390625, 20.69921875)" class="edgeLabel"><g transform="translate(-45.62890625, -13.19921875)" class="label"><foreignObject height="26.3984375" width="91.2578125"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="edgeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204); background-color: rgb(88, 88, 88); text-align: center;">ChatMessage</span></div></foreignObject></g></g><g transform="translate(936.7734375, 20.69921875)" class="edgeLabel"><g transform="translate(-20.796875, -13.19921875)" class="label"><foreignObject height="26.3984375" width="41.59375"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="edgeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204); background-color: rgb(88, 88, 88); text-align: center;">String</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(89.09765625, 20.69921875)" id="flowchart-A-16" class="node default default"><rect height="41.3984375" width="178.1953125" y="-20.69921875" x="-89.09765625" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-81.59765625, -13.19921875)" style="" class="label"><foreignObject height="26.3984375" width="163.1953125"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="nodeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204);">Input: topic&#x3D;ice cream</span></div></foreignObject></g></g><g transform="translate(323.30078125, 20.69921875)" id="flowchart-B-17" class="node default default"><rect height="41.3984375" width="132.9296875" y="-20.69921875" x="-66.46484375" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-58.96484375, -13.19921875)" style="" class="label"><foreignObject height="26.3984375" width="117.9296875"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="nodeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204);">PromptTemplate</span></div></foreignObject></g></g><g transform="translate(575.1953125, 20.69921875)" id="flowchart-C-19" class="node default default"><rect height="41.3984375" width="90.359375" y="-20.69921875" x="-45.1796875" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-37.6796875, -13.19921875)" style="" class="label"><foreignObject height="26.3984375" width="75.359375"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="nodeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204);">ChatModel</span></div></foreignObject></g></g><g transform="translate(826.3046875, 20.69921875)" id="flowchart-D-21" class="node default default"><rect height="41.3984375" width="129.34375" y="-20.69921875" x="-64.671875" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-57.171875, -13.19921875)" style="" class="label"><foreignObject height="26.3984375" width="114.34375"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="nodeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204);">StrOutputParser</span></div></foreignObject></g></g><g transform="translate(1011.90625, 20.69921875)" id="flowchart-F-23" class="node default default"><rect height="41.3984375" width="58.671875" y="-20.69921875" x="-29.3359375" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-21.8359375, -13.19921875)" style="" class="label"><foreignObject height="26.3984375" width="43.671875"><div xmlns="http://www.w3.org/1999/xhtml" style="box-sizing: border-box; display: inline-block; white-space: nowrap;"><span class="nodeLabel" style="box-sizing: border-box; fill: rgb(204, 204, 204); color: rgb(204, 204, 204);">Result</span></div></foreignObject></g></g></g></g></g></svg></p>
<p>Note that if you’re curious about the output of any components, you can always test out a smaller version of the chain such as <code>prompt</code> or <code>prompt | model</code> to see the intermediate results:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">input</span> = &#123;<span class="string">&quot;topic&quot;</span>: <span class="string">&quot;ice cream&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">prompt.invoke(<span class="built_in">input</span>)</span><br><span class="line"><span class="comment"># &gt; ChatPromptValue(messages=[HumanMessage(content=&#x27;tell me a short joke about ice cream&#x27;)])</span></span><br><span class="line"></span><br><span class="line">(prompt | model).invoke(<span class="built_in">input</span>)</span><br><span class="line"><span class="comment"># &gt; AIMessage(content=&quot;Why did the ice cream go to therapy?\nBecause it had too many toppings and couldn&#x27;t cone-trol itself!&quot;)</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.agiexplained.com">Eryx Lee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.agiexplained.com/2024/03/17/LangChain-LCEL-quickstart/">https://blog.agiexplained.com/2024/03/17/LangChain-LCEL-quickstart/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.agiexplained.com" target="_blank">AGI Explained</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/langchain/">langchain</a></div><div class="post_share"><div class="social-share" data-image="https://pics.agiexplained.com/i/2024/03/05/171847_2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/03/17/LangChain-LCEL-intro/" title="LangChain LCEL 简介"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">LangChain LCEL 简介</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/03/05/langchain-docker/" title="一个简单的langchain docker环境"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-05</div><div class="title">一个简单的langchain docker环境</div></div></a></div><div><a href="/2024/03/06/RAG-based-langchain-example/" title="一个基于RAG的对话系统的实现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-06</div><div class="title">一个基于RAG的对话系统的实现</div></div></a></div><div><a href="/2024/03/07/langchain-introduction/" title="langchain 简介"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-07</div><div class="title">langchain 简介</div></div></a></div><div><a href="/2024/03/07/langchain-application-develop-workflow/" title="langchain 应用基本开发流程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-07</div><div class="title">langchain 应用基本开发流程</div></div></a></div><div><a href="/2024/03/09/LangChain-libraries/" title="LangChain 库构成"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-09</div><div class="title">LangChain 库构成</div></div></a></div><div><a href="/2024/03/10/LangChain-quickstart/" title="快速构建 LangChain 应用（一）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-10</div><div class="title">快速构建 LangChain 应用（一）</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pics.agiexplained.com/i/2024/03/05/171847_2.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Eryx Lee</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/eryxlee"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-example-prompt-model-output-parser"><span class="toc-number">1.</span> <span class="toc-text">Basic example: prompt + model + output parser</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Prompt"><span class="toc-number">1.1.</span> <span class="toc-text">1. Prompt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Model"><span class="toc-number">1.2.</span> <span class="toc-text">2. Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Output-parser"><span class="toc-number">1.3.</span> <span class="toc-text">3. Output parser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Entire-Pipeline"><span class="toc-number">1.4.</span> <span class="toc-text">4. Entire Pipeline</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/17/LangChain-LCEL-quickstart/" title="LangChain LCEL quickstart">LangChain LCEL quickstart</a><time datetime="2024-03-17T13:36:54.000Z" title="发表于 2024-03-17 21:36:54">2024-03-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/17/LangChain-LCEL-intro/" title="LangChain LCEL 简介">LangChain LCEL 简介</a><time datetime="2024-03-17T13:36:21.000Z" title="发表于 2024-03-17 21:36:21">2024-03-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/15/LangChain-langserve/" title="LangChain LangServe入门">LangChain LangServe入门</a><time datetime="2024-03-15T00:27:42.000Z" title="发表于 2024-03-15 08:27:42">2024-03-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/13/LangChain-quickstart-4/" title="快速构建 LangChain 应用（四）">快速构建 LangChain 应用（四）</a><time datetime="2024-03-13T01:23:02.000Z" title="发表于 2024-03-13 09:23:02">2024-03-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/12/LangChain-quickstart-3/" title="快速构建 LangChain 应用（三）">快速构建 LangChain 应用（三）</a><time datetime="2024-03-11T22:02:11.000Z" title="发表于 2024-03-12 06:02:11">2024-03-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By Eryx Lee</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" href="https://beian.miit.gov.cn/">浙ICP备2024062350号-1</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const disqus_config = function () {
    this.page.url = 'https://blog.agiexplained.com/2024/03/17/LangChain-LCEL-quickstart/'
    this.page.identifier = '/2024/03/17/LangChain-LCEL-quickstart/'
    this.page.title = 'LangChain LCEL quickstart'
  }

  const disqusReset = () => {
    window.DISQUS && window.DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addGlobalFn('themeChange', disqusReset, 'disqus')

  const loadDisqus = () =>{
    if (window.DISQUS) disqusReset()
    else {
      const script = document.createElement('script')
      script.src = 'https://EryxLee.disqus.com/embed.js'
      script.setAttribute('data-timestamp', +new Date())
      document.head.appendChild(script)
    }
  }

  const getCount = async() => {
    try {
      const eleGroup = document.querySelector('#post-meta .disqus-comment-count')
      if (!eleGroup) return
      const cleanedLinks = eleGroup.href.replace(/#post-comment$/, '')

      const res = await fetch(`https://disqus.com/api/3.0/threads/set.json?forum=EryxLee&api_key=&thread:link=${cleanedLinks}`,{
        method: 'GET'
      })
      const result = await res.json()

      const count = result.response.length ? result.response[0].posts : 0
      eleGroup.textContent = count
    } catch (err) {
      console.error(err)
    }
  }

  if ('Disqus' === 'Disqus' || !false) {
    if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
    else {
      loadDisqus()
      
    }
  } else {
    window.loadOtherComment = loadDisqus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>